<!-- template example by Mark Otto, Jacob Thornton, and Bootstrap contributors => https://getbootstrap.com/docs/5.1/examples/dashboard -->
{% set languageCode = localization.code ?? 'en' %}
{% set navbarColor = meta['navbar']|default('primary') %}
{% set home_path = 'home'|link|trim('/', 'right') %}
<!DOCTYPE html>
<html lang="{{ languageCode }}">
    <head>
        <meta charset="utf-8">
        <title>{{ (title is not empty ? title : 'dashboard'|text)|e }}</title>
        <meta name="robots" content="{{ meta['robots']|default('index,follow')|e }}">
        {% if description is not empty %}<meta name="description" content="{{ description|e }}">{% endif %}
        {% if meta['author'] is not empty %}<meta name="author" content="{{ meta['author'] }}">{% endif %}
        {% if meta['generator'] is not empty %}<meta name="generator" content="{{ meta['generator']|e }}">{% endif %}
        {% if meta['keywords'] is not empty %}<meta name="keywords" content="{{ meta['keywords']|e }}">{% endif %}
        {% if meta['favico'] is not empty %}<link rel="icon" href="{{ meta['favico'] }}" type="image/x-icon">{% endif %}
        {% if meta['shortcut_icon'] is not empty %}<link rel="shortcut icon" href="{{ meta['shortcut_icon'] }}" type="image/png">{% endif %}
        {% if meta['apple_touch_icon'] is not empty %}<link rel="apple-touch-icon" href="{{ meta['apple_touch_icon'] }}">{% endif %}
        <meta name="viewport" content="width=device-width, initial-scale=1">
        {% if meta['google-site-verification'] is not empty %}<meta name="google-site-verification" content="{{ meta['google-site-verification']|e }}">{% endif %}
        {% if meta['mobile-web-app-capable'] is not empty %}<meta name="mobile-web-app-capable" content="{{ meta['mobile-web-app-capable']|e }}">{% endif %}
        {% if meta['apple-mobile-web-app-status-bar-style'] is not empty %}<meta name="apple-mobile-web-app-status-bar-style" content="{{ meta['apple-mobile-web-app-status-bar-style']|e }}">{% endif %}
        {% if meta['socials']['og']['title'] is not empty %}<meta property="og:title" content="{{ meta['socials']['og']['title']|e }}">{% endif %}
        {% if meta['socials']['og']['description'] is not empty %}<meta property="og:description" content="{{ meta['socials']['og']['description']|e }}">{% endif %}
        {% if meta['socials']['og']['type'] is not empty %}<meta property="og:type" content="{{ meta['socials']['og']['type']|e }}">{% endif %}
        {% if meta['socials']['og']['url'] is not empty %}<meta property="og:url" content="{{ meta['socials']['og']['url']|e }}">{% endif %}
        {% if meta['socials']['og']['site_name'] is not empty %}<meta property="og:site_name" content="{{ meta['socials']['og']['site_name']|e }}">{% endif %}
        {% if meta['socials']['og']['image'] is not empty %}<meta property="og:image" content="{{ meta['socials']['og']['image']|e }}">{% endif %}
        {% if meta['socials']['og']['image:width'] is not empty %}<meta property="og:image:width" content="{{ meta['socials']['og']['image:width']|e }}">{% endif %}
        {% if meta['socials']['og']['image:height'] is not empty %}<meta property="og:image:height" content="{{ meta['socials']['og']['image:height']|e }}">{% endif %}
        {% if meta['socials']['fb']['app_id'] is not empty %}<meta property="fb:app_id" content="{{ meta['socials']['fb']['app_id']|e}}">{% endif %}
        {% if meta['socials']['fb']['page_id'] is not empty %}<meta property="fb:page_id" content="{{ meta['socials']['fb']['page_id']|e }}">{% endif %}
        {% if meta['socials']['fb']['admins'] is not empty %}<meta property="fb:admins" content="{{ meta['socials']['fb']['admins']|e }}">{% endif %}
        {% if meta['socials']['twitter']['card'] is not empty %}<meta name="twitter:card" content="{{ meta['socials']['twitter']['card']|e }}">{% endif %}
        {% if meta['socials']['twitter']['url'] is not empty %}<meta name="twitter:url" content="{{ meta['socials']['twitter']['url']|e }}">{% endif %}
        {% if meta['socials']['twitter']['title'] is not empty %}<meta name="twitter:title" content="{{ meta['socials']['twitter']['title']|e }}">{% endif %}
        {% if meta['socials']['twitter']['description'] is not empty %}<meta name="twitter:description" content="{{ meta['socials']['twitter']['description']|e }}">{% endif %}
        {% if meta['socials']['twitter']['image'] is  not empty %}<meta name="twitter:image" content="{{ meta['socials']['twitter']['image']|e }}">{% endif %}
        {% if meta['socials']['twitter']['image:width'] is not empty %}<meta name="twitter:image:width" content="{{ meta['socials']['twitter']['image:width']|e }}">{% endif %}
        {% if meta['socials']['twitter']['image:height'] is not empty %}<meta name="twitter:image:height" content="{{ meta['socials']['twitter']['image:height']|e }}">{% endif %}
        {% if meta['socials']['twitter']['site'] is not empty %}<meta name="twitter:site" content="{{ meta['socials']['twitter']['site']|e }}">{% endif %}
        
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <link href="https://cdn.jsdelivr.net/gh/codesaur-php/HTML-Assets@2.5.3/styles/bootstrap-extend.css" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/gh/codesaur-php/HTML-Assets@2.5.3/styles/dashboard.css" rel="stylesheet">

        <!-- JavaScript Bundle with Popper -->
        <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
        <script defer src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <script defer src="https://cdn.jsdelivr.net/gh/codesaur-php/HTML-Assets@2.5.3/scripts/spinner.js"></script>
        <script defer src="https://cdn.jsdelivr.net/gh/codesaur-php/HTML-Assets@2.5.3/scripts/ScrollUp.js"></script>
        <script defer src="https://cdn.jsdelivr.net/gh/codesaur-php/HTML-Assets@2.5.3/scripts/NotifyTop.js"></script>
        <script defer src="https://cdn.jsdelivr.net/gh/codesaur-php/HTML-Assets@2.5.3/scripts/AjaxModal.js"></script>
        <script defer src="https://cdn.jsdelivr.net/gh/codesaur-php/HTML-Assets@2.5.3/scripts/imageInput.js"></script>
        <script defer src="https://cdn.jsdelivr.net/gh/codesaur-php/HTML-Assets@2.5.3/scripts/FormSubmitHandler.js"></script>
        <script defer src="https://cdn.jsdelivr.net/gh/codesaur-php/HTML-Assets@2.5.3/scripts/Dashboard.js"></script>
    </head>
    <body>
        <header class="navbar navbar-dark sticky-top bg-{{ navbarColor }} flex-md-nowrap p-0 shadow">
            <a class="navbar-brand col-md-3 col-lg-2 me-0 px-3 text-uppercase" href="{{ home_path }}">
                {% if user.getOrganization()['logo'] is not empty %}<img src="{{ user.getOrganization()['logo'] }}">{% endif %}
                {{ user.getOrganization()['name'] }}
            </a>
            <button class="navbar-toggler position-absolute d-md-none collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <input class="form-control form-control-dark w-100" type="text" placeholder="{{ 'search'|text|e }}" aria-label="{{ 'search'|text|e }}" />
            <div class="dropdown px-2 lang-menu">
                <button class="btn btn-{{ navbarColor }}" type="button" id="dropdownLanguage" data-bs-toggle="dropdown" aria-expanded="false">
                    <img class="shadow-sm" src="https://cdn.jsdelivr.net/gh/codesaur-php/HTML-Assets@2.5.3/flags/{{ languageCode }}.png">
                </button>
                <div class="dropdown-menu bg-dark dropdown-menu-lg-end" aria-labelledby="dropdownLanguage">
                    {% for lang, country in localization.language %}
                    <a class="dropdown-item{{ lang == languageCode ? ' active' : '' }}" href="{{ 'language'|link({'code': lang}) }}">
                        <img src="https://cdn.jsdelivr.net/gh/codesaur-php/HTML-Assets@2.5.3/flags/{{ lang }}.png"> {{ country }}
                    </a>
                    {% endfor %}
                </div>
            </div>
        </header>
        <div class="container-fluid">
            <div class="row">
                <nav class="col-md-3 col-lg-2 d-md-block bg-dark sidebar collapse" id="sidebarMenu">
                    {% for menu in sidemenu %}
                    <div class="position-sticky mt-{{ loop.first ? '3' : '1' }}">
                        <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-3 mb-1 text-muted">
                            <span>{{ menu['title'] }}</span>
                        </h6>
                        <ul class="nav flex-column">
                        {% for item in menu['submenu'] %}
                            <li class="nav-item">
                                {% set href = item['href']|trim('/', 'right') %}
                                <a class="nav-link{{ href == request_path or (href in request_path and href != home_path) ? ' active' : '' }}" href="{{ href }}">
                                    <i class="{{ item['icon'] }} side-menu-icon"></i> {{ item['title'] }}
                                </a>
                            </li>
                        {% endfor %}
                        </ul>
                    </div>
                    {% endfor %}
                    <div class="position-sticky pb-3 mt-5">
                        <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-2 mb-1 text-muted">
                            <a class="link-secondary text-decoration-none" href="{{ 'logout'|link }}">{{ 'account'|text }}</a>
                            <a class="link-secondary" href="{{ 'logout'|link }}" aria-label="{{ 'logout'|text }}">
                                <i class="bi bi-box-arrow-right sidebar-logout-icon"></i>
                            </a>
                        </h6>
                        <ul class="nav flex-column">
                            {% set account_profile_link = 'account-update'|link({'id': user.getAccount()['id']}) %}
                            <li class="nav-item">
                                <a class="nav-link{{ request_path == account_profile_link ? ' active' : '' }}" href="{{ account_profile_link }}">
                                {% if user.getAccount()['photo'] is not empty %}
                                    <img class="account-profile-photo rounded-circle shadow-sm" src="{{ user.getAccount()['photo'] }}">
                                {% else %}
                                    <i class="bi bi-person-circle side-menu-icon"></i>
                                {% endif %}
                                    {{ user.getAccount()['first_name'] ~ ' ' ~ user.getAccount()['last_name'] }}
                                </a>
                            </li>
                            {% if user.getOrganizations()|length > 1 %}
                            <li class="nav-item">
                                <a class="nav-link{{ request_path == 'organization-user'|link ? ' active' : '' }}" href="{{ 'organization-user'|link }}">
                                    <i class="bi bi-bank side-menu-icon"
                                    {% if user.getAccount()['photo'] is not empty %} style="position:relative;left:7px;margin-right:15px"{% endif %}}></i> {{ 'organization'|text }}
                                </a>
                            </li>
                            {% endif %}
                        </ul>
                    </div>
                </nav>
                <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 mt-3">{{ content }}</main>
            </div>
        </div>
        <script type="text/javascript">
            window.texts = {
                'success': "{{ 'success'|text|e }}",
                'error': "{{ 'error'|text|e }}",
                'form-validation-error': "{{ 'u-have-some-form-errors'|text|e }}"
            };
            document.addEventListener('DOMContentLoaded', function () {
                Dashboard.init("{{ ('loading')|text|e }}");
            });
        </script>
        {% if meta['socials']['google']['analytics']['id'] is not empty %}
        <script type="text/javascript">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments);},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m);
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
            ga('create', '{{ meta['socials']['google']['analytics']['id']|e }}', 'auto'); ga('send', 'pageview');
        </script>
        {%  endif %}
        {% if meta['socials']['fb']['page']['id'] is not empty %}
        <div id="fb-root"></div>
        <script type="text/javascript">
            window.fbAsyncInit = function() {
                FB.init({xfbml: true, version : 'v3.3'});
            };
            (function(d, s, id) {
                var js, fjs = d.getElementsByTagName(s)[0];
                if (d.getElementById(id)) return;
                js = d.createElement(s); js.id = id;
                js.src = 'https://connect.facebook.net/en_US/sdk/xfbml.customerchat.js#xfbml=1&version=v2.12&autoLogAppEvents=1';
                fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));
        </script>
        <div class="fb-customerchat" attribution=setup_tool page_id="{{ meta['fb']['page']['id'] }}"
            {% if meta['socials']['fb']['page']['messenger_theme_color'] is not empty %} theme_color="{{ meta['socials']['fb']['page']['messenger_theme_color']|e }}"{% endif %}
            logged_in_greeting="{{ meta['socials']['fb']['page']['messenger_in_greeting']|default('Сайн байна уу? Бидэнтэй холбогдож байгаа таньд баярлалаа')|e }}"
            logged_out_greeting="{{ meta['socials']['fb']['page']['messenger_out_greeting']|default('Сайн байна уу? Бидэнтэй холбогдож байгаа таньд баярлалаа')|e }}">
        </div>
        {% endif %}
    </body>
</html>
